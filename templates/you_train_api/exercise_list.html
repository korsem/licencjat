{% extends 'main/base.html' %}

{% block title %}Exercises{% endblock %}

{% block content %}
<h1>Exercises</h1>

<form method="get" class="mb-3">
    <div class="row">
        <div class="col-md-4">
            <label for="filter_by">Filter by:</label>
            <select id="filter_by" class="form-control mb-3" onchange="showFilterOptions(this.value)">
                <option value="">Select filter type</option>
                <option value="muscle_group">Muscle Group</option>
                <option value="cardio">Cardio</option>
                <option value="equipment">Equipment</option>
            </select>

            <div id="muscle_group_filters" style="display: none;">
                <label>Filter by muscle group:</label>
                <div>
                    {% for value, label in MUSCLE_GROUP_CHOICES %}
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="muscle_group" value="{{ value }}" id="muscle_group_{{ value }}" {% if value in selected_muscle_groups %}checked{% endif %}>
                            <label class="form-check-label" for="muscle_group_{{ value }}">{{ label }}</label>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div id="cardio_filters" style="display: none;">
                <label>Filter by cardio:</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="is_cardio" id="is_cardio" {% if is_cardio %}checked{% endif %}>
                    <label class="form-check-label" for="is_cardio">Cardio Exercises</label>
                </div>
            </div>

            <div id="equipment_filters" style="display: none;">
                <label>Filter by equipment:</label>
                <div>
                    {% for equipment in equipment_list %}
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="equipment" value="{{ equipment.name }}" id="equipment_{{ equipment.id }}" {% if equipment.name in selected_equipment %}checked{% endif %}>
                            <label class="form-check-label" for="equipment_{{ equipment.id }}">{{ equipment.name }}</label>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <label for="search">Search:</label>
            <input type="text" name="search" id="search" class="form-control" value="{{ search_query }}">
        </div>
        <div class="col-md-4">
            <label for="sort_by">Sort by:</label>
            <select name="sort_by" id="sort_by" class="form-control">
                <option value="">Default</option>
                <option value="name" {% if sort_by == "name" %}selected{% endif %}>Name</option>
                <option value="muscle_group" {% if sort_by == "muscle_group" %}selected{% endif %}>Muscle Group</option>
                <option value="equipment" {% if sort_by == "equipment" %}selected{% endif %}>Equipment</option>
            </select>
            <button type="submit" class="btn btn-primary mt-4">Apply Filters</button>
        </div>
    </div>
</form>

<ul>
    {% for exercise in exercises %}
    <li>
        <a href="{% url 'exercise_detail' exercise.id %}">{{ exercise.name }}</a> - {{ exercise.description }} - {{ exercise.muscle_group }} - {{ exercise.equipment }}
    </li>
    {% endfor %}
</ul>

<a href="{% url 'add_exercise' %}" class="btn btn-secondary mt-4">Add Exercise</a>

<script>
    function showFilterOptions(value) {
        document.getElementById('muscle_group_filters').style.display = value === 'muscle_group' ? 'block' : 'none';
        document.getElementById('cardio_filters').style.display = value === 'cardio' ? 'block' : 'none';
        document.getElementById('equipment_filters').style.display = value === 'equipment' ? 'block' : 'none';
    }
</script>

{% endblock %}
